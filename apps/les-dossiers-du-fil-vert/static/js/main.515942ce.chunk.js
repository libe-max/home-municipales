(this["webpackJsonplibe-apps-template"]=this["webpackJsonplibe-apps-template"]||[]).push([[0],{140:function(e,t){},152:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a(3),r=a(5),i=a(4),l=a(7),o=a(6),s=a(0),d=a.n(s),u=a(66),m=a.n(u),h=a(67);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var p=a(29),v=a(22),_=a.n(v),y=a(68),b=a(19),g=a(20),f=a(24),w=a(25),L=(a(32),a(9)),E=a(26),k=a(8),B=a(27),O=a(13),j=a(28),C=a(17),S=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(i.a)(t).call(this))).c="home-municipales__tile",e}return Object(o.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.c,t=this.props,a={backgroundImage:"url(".concat(t.photo_url,")")},n=[e];return n.push("".concat(e,"_").concat(t.pos)),t.active&&n.push("".concat(e,"_active")),t.subscribers&&"0"!==t.subscribers&&n.push("".concat(e,"_subscribers-only")),d.a.createElement("div",{className:n.join(" "),onClick:this.toggleActive},d.a.createElement("a",{href:t.article_url,target:"blank"},d.a.createElement("div",{className:"".concat(e,"-inner")},d.a.createElement("div",{className:"".concat(e,"-photo"),style:a}),d.a.createElement("div",{className:"".concat(e,"-titles")},d.a.createElement("div",{className:"".concat(e,"-slug-and-subscribers")},d.a.createElement("div",{className:"".concat(e,"-slug")},d.a.createElement(O.a,null,t.slug)),d.a.createElement("div",{className:"".concat(e,"-subscribers-only")},d.a.createElement(O.a,null,"Abonn\xe9s"))),d.a.createElement("div",{className:"".concat(e,"-title")},d.a.createElement(j.a,t.textSizes,d.a.createElement(C.a,{content:t.display_title})))))))}}]),t}(s.Component),A=a(12),N=a(21),G=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(i.a)(t).call(this))).c="home-municipales__small-tile",e}return Object(o.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.c,t=this.props,a={backgroundImage:"url(".concat(t.photo_url,")")},n=[e];return t.subscribers&&"0"!==t.subscribers&&n.push("".concat(e,"_subscribers-only")),d.a.createElement("div",{className:n.join(" ")},d.a.createElement("a",{href:t.article_url,target:"blank"},d.a.createElement("div",{className:"".concat(e,"-inner")},d.a.createElement("div",{className:"".concat(e,"-titles")},d.a.createElement("div",{className:"".concat(e,"-title")},d.a.createElement(k.a,null,d.a.createElement(C.a,{content:t.display_title||t.original_title||"Article sans titre"}))),d.a.createElement("div",{className:"".concat(e,"-date")},d.a.createElement(A.a,null,d.a.createElement(N.a,null),"\xa0\xa0",t.display_date,"\xa0\xa0",d.a.createElement("span",{className:"".concat(e,"-subscribers-only")},d.a.createElement(O.a,{small:!0},"Abonn\xe9s"))))),d.a.createElement("div",{className:"".concat(e,"-photo"),style:a}))))}}]),t}(s.Component),x=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(i.a)(t).call(this))).state={nb_displayed:4},e.c="home-municipales__category-index",e.handleShowMoreClick=e.handleShowMoreClick.bind(Object(l.a)(e)),e}return Object(o.a)(t,e),Object(c.a)(t,[{key:"handleShowMoreClick",value:function(){this.setState({nb_displayed:this.state.nb_displayed+8})}},{key:"render",value:function(){var e=this.c,t=this.props,a=this.state,n=[e];return n.push("".concat(e,"_").concat(t.category.category)),t.articles.length>a.nb_displayed&&n.push("".concat(e,"_display-show-more")),d.a.createElement("div",{className:n.join(" ")},d.a.createElement("div",{className:"".concat(e,"-title")},d.a.createElement(O.a,{big:!0},d.a.createElement(C.a,{content:t.category.category_name}))),d.a.createElement("div",{className:"".concat(e,"-list")},t.articles.slice(0,a.nb_displayed).map((function(t){return d.a.createElement("div",{className:"".concat(e,"-article"),key:t.article_url||Math.random().toString(36)},d.a.createElement(G,t))}))),d.a.createElement("div",{className:"".concat(e,"-show-more"),onClick:this.handleShowMoreClick},d.a.createElement(k.a,{small:!0},d.a.createElement("a",null,"Voir plus"))))}}]),t}(s.Component),F=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(i.a)(t).call(this))).c="home-municipales__filters-block",e.handleFilterClick=e.handleFilterClick.bind(Object(l.a)(e)),e}return Object(o.a)(t,e),Object(c.a)(t,[{key:"handleFilterClick",value:function(e,t){}},{key:"render",value:function(){var e=this,t=this.c,a=this.props,n=a.active,c=a.categories,r=(a.activateCategory,[]);c.forEach((function(a){var c=["".concat(t,"-filter")];c.push("".concat(t,"-filter_").concat(a.category)),n&&a.category!==n||c.push("".concat(t,"-filter_active")),r.push(d.a.createElement("button",{disabled:!0,key:a.category,className:c.join(" "),onClick:function(t){return e.handleFilterClick(t,a)}},d.a.createElement(k.a,null,d.a.createElement(C.a,{content:a.category_name})))),r.push(d.a.createElement("div",{key:"".concat(a.category,"-separator"),className:"".concat(t,"-filter-separator")},d.a.createElement(k.a,null,"\u2022")))})),r.pop();var i=[t];return n||i.push("".concat(t,"_all-active")),d.a.createElement("div",{className:i.join(" ")},r)}}]),t}(s.Component),T=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(i.a)(t).call(this))).c="home-municipales",e.nb_tiles=8,Object.defineProperty(Object(l.a)(e),"nb_tiles",{get:function(){return"lg"===window.LBLB_GLOBAL.current_display?8:4}}),e.state={loading_sheet:!0,error_sheet:null,data_sheet:[],keystrokes_history:[],konami_mode:!1,active_category:null,scrolled:!1},e.fetchSheet=e.fetchSheet.bind(Object(l.a)(e)),e.fetchCredentials=e.fetchCredentials.bind(Object(l.a)(e)),e.listenToKeyStrokes=e.listenToKeyStrokes.bind(Object(l.a)(e)),e.watchForKonamiCode=e.watchForKonamiCode.bind(Object(l.a)(e)),e.activateCategory=e.activateCategory.bind(Object(l.a)(e)),e.isInFilter=e.isInFilter.bind(Object(l.a)(e)),e.scrollToFirstActiveArticle=e.scrollToFirstActiveArticle.bind(Object(l.a)(e)),e.toggleScrolledState=e.toggleScrolledState.bind(Object(l.a)(e)),e}return Object(o.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){return document.addEventListener("keydown",this.listenToKeyStrokes),document.addEventListener("scroll",this.toggleScrolledState),this.fetchCredentials(),this.props.spreadsheet?this.fetchSheet():this.setState({loading_sheet:!1})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.listenToKeyStrokes)}},{key:"shouldComponentUpdate",value:function(e,t){var a=this,n=[];return Object.keys(t).forEach((function(e){a.state[e]!==t[e]&&n.push(e)})),1!==n.length||!n.includes("keystrokes_history")}},{key:"fetchCredentials",value:function(){var e,t,a,n,c,r,i,l,o,s;return _.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return e=this.props.api_url,t=this.props.tracking,a=t.format,n=t.article,c="".concat(e,"/").concat(a,"/").concat(n,"/load"),d.prev=3,d.next=6,_.a.awrap(window.fetch(c,{method:"POST"}));case 6:return r=d.sent,d.next=9,_.a.awrap(r.json());case 9:return i=d.sent,l=i._credentials,o=l.lblb_tracking,s=l.lblb_posting,window.LBLB_GLOBAL||(window.LBLB_GLOBAL={}),window.LBLB_GLOBAL.lblb_tracking=o,window.LBLB_GLOBAL.lblb_posting=s,d.abrupt("return",{lblb_tracking:o,lblb_posting:s});case 17:return d.prev=17,d.t0=d.catch(3),console.error("Unable to fetch credentials:"),console.error(d.t0),d.abrupt("return",Error(d.t0));case 22:case"end":return d.stop()}}),null,this,[[3,17]])}},{key:"fetchSheet",value:function(){var e,t,a,n,c;return _.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return this.setState({loading_sheet:!0,error_sheet:null}),e=this.props.spreadsheet,r.prev=2,r.next=5,_.a.awrap(window.fetch(this.props.spreadsheet));case 5:if((t=r.sent).ok){r.next=8;break}throw t;case 8:return r.next=10,_.a.awrap(t.text());case 10:return a=r.sent,n=Object(y.parseTsv)(a,[9])[0],this.setState({loading_sheet:!1,error_sheet:null,data_sheet:n}),document.querySelector("#temp-header").innerHTML="",r.abrupt("return",a);case 17:if(r.prev=17,r.t0=r.catch(2),!r.t0.status){r.next=26;break}return c="".concat(r.t0.status," error while fetching : ").concat(e),this.setState({loading_sheet:!1,error_sheet:r.t0}),console.error(c,r.t0),r.abrupt("return",Error(c));case 26:return this.setState({loading_sheet:!1,error_sheet:r.t0}),console.error(r.t0),r.abrupt("return",Error(r.t0));case 29:case"end":return r.stop()}}),null,this,[[2,17]])}},{key:"listenToKeyStrokes",value:function(e){if(e&&e.keyCode){var t=this.state.keystrokes_history,a=[].concat(Object(p.a)(t),[e.keyCode]);this.setState({keystrokes_history:a}),this.watchForKonamiCode()}}},{key:"watchForKonamiCode",value:function(){"38,38,40,40,37,39,37,39,66,65"===this.state.keystrokes_history.slice(-10).join(",")&&this.setState({konami_mode:!0})}},{key:"activateCategory",value:function(e){var t=e!==this.state.active_category?e:null;this.setState({active_category:t},this.scrollToFirstActiveArticle)}},{key:"isInFilter",value:function(e){var t=this.state.active_category;return!t||e.category===t}},{key:"scrollToFirstActiveArticle",value:function(){var e=this,t=this.state.active_category;if(!t)return window.scrollTo({top:0,left:0,behavior:"smooth"});var a=this.state.data_sheet.findIndex((function(t){return e.isInFilter(t)})),n=(a<this.nb_tiles?document.querySelector(".home-municipales__tile_".concat(a+1)):document.querySelector(".home-municipales__category-index_".concat(t))).getBoundingClientRect().y+window.scrollY,c=window.LBLB_GLOBAL.nav_height,r=window.LBLB_GLOBAL.rem;window.scrollTo({top:n-c-3.5*r,left:0,behavior:"smooth"})}},{key:"toggleScrolledState",value:function(e){var t=window.LBLB_GLOBAL.pScrollY||0;t<180&&window.scrollY>=180?this.setState({scrolled:!0}):t>=180&&window.scrollY<180&&this.setState({scrolled:!1}),window.LBLB_GLOBAL.pScrollY=window.scrollY}},{key:"render",value:function(){var e=this,t=this.c,a=this.state,n=this.props,c=this.state.data_sheet,r=[];c.forEach((function(e){var t=r.find((function(t){return t.category===e.category}));t?t.occurences++:r.push({category:e.category,category_name:e.category_name,occurences:1})}));var i=[].concat(r),l=i[0]?i[0].category:"",o=i[0]?i[0].category_name:"",s="".concat((o[0]||"").toLowerCase()).concat(o.slice(1).replace(/&nbsp;/gim," ")),u="A lire ce mois-ci dans Les dossiers du fil vert : ".concat(s," via @libe"),m=c.filter((function(e){return e.category===l})),h=m.length>=6&&m.length<=12?m.length:m.length<6?6:12,p=h===m.length,v=[t];return v.push("".concat(t,"_").concat(h,"-tiles")),a.loading_sheet&&v.push("".concat(t,"_loading")),a.error_sheet&&v.push("".concat(t,"_error")),a.scrolled&&v.push("".concat(t,"_scrolled")),a.loading_sheet?d.a.createElement("div",{className:v.join(" ")},d.a.createElement("div",{className:"lblb-default-apps-loader"},d.a.createElement(b.a,null))):a.error_sheet?d.a.createElement("div",{className:v.join(" ")},d.a.createElement("div",{className:"lblb-default-apps-error"},d.a.createElement(g.a,null))):d.a.createElement("div",{className:v.join(" ")},d.a.createElement("div",{className:"".concat(t,"__header")},d.a.createElement("div",{className:"".concat(t,"__header-logo"),onClick:function(t){return e.activateCategory(null)}},d.a.createElement(L.a,{src:"./logo.svg"})),d.a.createElement("div",{className:"".concat(t,"__header-filters")},d.a.createElement("div",{className:"".concat(t,"__header-filters-title"),onClick:function(t){return e.activateCategory(null)}},d.a.createElement(E.a,null,"Les dossiers du fil vert")),d.a.createElement("div",{className:"".concat(t,"__header-filters-list")},d.a.createElement(F,{categories:i.map((function(e){return{category_name:e.category_name,category:e.category}})).slice(0,1),activateCategory:this.activateCategory,active:a.active_category})))),d.a.createElement("div",{className:"".concat(t,"__scroll-to-top"),onClick:function(t){return e.activateCategory(null)}},d.a.createElement(L.a,{src:"./logo.svg"}),d.a.createElement(B.a,null,"Retour \xe0 la une")),d.a.createElement("div",{className:"".concat(t,"__fixed-header-mobile"),style:{top:window.LBLB_GLOBAL.nav_height}},d.a.createElement("div",{onClick:function(t){return e.activateCategory(null)},className:"".concat(t,"__fixed-header-mobile-logo")},d.a.createElement(k.a,null,"Les dossiers",d.a.createElement("br",null),"du fil vert")),d.a.createElement("div",{onClick:function(t){return e.activateCategory(null)},className:"".concat(t,"__fixed-header-mobile-filters")},d.a.createElement(k.a,null,"\u2191 Filtres"))),d.a.createElement("div",{className:"".concat(t,"__tiles")},m.map((function(t,a){return console.log(t),0===a?d.a.createElement(S,Object.assign({pos:a+1},t,{textSizes:{big:!0},key:t.display_title,dataCategory:t.category,active:e.isInFilter(t)})):a<4?d.a.createElement(S,Object.assign({pos:a+1},t,{textSizes:{regular:!0},key:t.display_title,dataCategory:t.category,active:e.isInFilter(t)})):d.a.createElement(S,Object.assign({pos:a+1},t,{textSizes:{small:!0},key:t.display_title,dataCategory:t.category,active:e.isInFilter(t)}))}))),d.a.createElement("div",{className:"".concat(t,"__categories")},!p&&1!==i.length&&d.a.createElement("div",{className:"".concat(t,"__categories-title")},d.a.createElement(k.a,null,"Retrouvez tous les dossiers du fil vert")),d.a.createElement("div",{className:"".concat(t,"__categories-list")},i.map((function(e){if(!p||e.category!==l){var t=c.filter((function(t){return t.category===e.category}));return d.a.createElement(x,{key:e.category,articles:t,category:e})}})))),d.a.createElement("div",{className:"lblb-default-apps-footer"},d.a.createElement(f.a,{short:!0,iconsOnly:!0,tweet:u,url:n.meta.url}),d.a.createElement(w.a,{target:"blank"})))}}]),t}(s.Component),I=a(48),K=a.n(I),M=(a(151),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(i.a)(t).call(this,e))).getElementsHeight=a.getElementsHeight.bind(Object(l.a)(a)),window.LBLB_GLOBAL||(window.LBLB_GLOBAL={}),window.LBLB_GLOBAL.rem=16,window.LBLB_GLOBAL.breakpoints={lg:{min:1+63*window.LBLB_GLOBAL.rem,max:1/0},md:{min:1+40*window.LBLB_GLOBAL.rem,max:63*window.LBLB_GLOBAL.rem},sm:{min:0,max:40*window.LBLB_GLOBAL.rem}},Object.defineProperty(window.LBLB_GLOBAL,"current_display",{get:function(){var e=this;return Object.keys(this.breakpoints).find((function(t){return e.breakpoints[t].min<=e.client_width&&e.breakpoints[t].max>=e.client_width}))}}),window.setInterval(a.getElementsHeight,250),a}return Object(o.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){window.clearInterval(this.getElementsHeight)}},{key:"componentDidMount",value:function(){if(K.a.show_header){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src","https://www.liberation.fr/menu/script.js"),document.body.appendChild(e)}}},{key:"getElementsHeight",value:function(){var e=document.querySelector(".header-fix-nav"),t=document.querySelector("body"),a=window.LBLB_GLOBAL.nav_height,n=window.LBLB_GLOBAL.body_padding_top,c=window.LBLB_GLOBAL.client_width,r=window.LBLB_GLOBAL.client_height,i=e?e.offsetHeight:0,l=t?parseFloat(window.getComputedStyle(t)["padding-top"].slice(0,-2)):0,o=document.documentElement.clientWidth,s=document.documentElement.clientHeight,d=window.LBLB_GLOBAL.current_display;window.LBLB_GLOBAL.nav_height=i,window.LBLB_GLOBAL.body_padding_top=l,window.LBLB_GLOBAL.client_width=o,window.LBLB_GLOBAL.client_height=s,a===i&&n===l&&c===o&&r===s||window.dispatchEvent(new CustomEvent("lblb-client-dimensions-change")),d!==window.LBLB_GLOBAL.current_display&&window.dispatchEvent(new CustomEvent("lblb-client-display-change"))}},{key:"render",value:function(){var e=this.props,t=e.meta,a=e.statics_url,n=e.stylesheet,c=t.title,r=t.url,i=t.description,l=t.author,o=t.image;return d.a.createElement("div",{id:"libe-labo-app-wrapper"},d.a.createElement(h.Helmet,null,d.a.createElement("title",null,"Lib\xe9ration.fr \u2013 ",c),d.a.createElement("link",{rel:"canonical",href:r}),d.a.createElement("meta",{name:"author",content:l}),d.a.createElement("meta",{name:"description",content:i}),d.a.createElement("meta",{property:"og:url",content:r}),d.a.createElement("meta",{property:"og:title",content:c}),d.a.createElement("meta",{property:"og:description",content:i}),d.a.createElement("meta",{property:"og:image",content:o}),d.a.createElement("meta",{name:"twitter:url",content:r}),d.a.createElement("meta",{name:"twitter:title",content:c}),d.a.createElement("meta",{name:"twitter:description",content:i}),d.a.createElement("meta",{name:"twitter:image",content:o}),d.a.createElement("link",{rel:"stylesheet",href:"".concat(a,"/styles/liberation.css")}),d.a.createElement("link",{rel:"stylesheet",href:"".concat(a,"/lib/normalize-8.0.0.css")}),d.a.createElement("link",{rel:"stylesheet",href:"".concat(a,"/styles/fonts.css")}),d.a.createElement("link",{rel:"stylesheet",href:"".concat(a,"/styles/font-classes.css")}),d.a.createElement("link",{rel:"stylesheet",href:"".concat(a,"/styles/components.css")}),d.a.createElement("link",{rel:"stylesheet",href:"".concat(a,"/styles/apps.css")}),d.a.createElement("link",{rel:"stylesheet",href:"".concat(a,"/lib/leaflet-1.4.0/leaflet.css")}),d.a.createElement("link",{rel:"stylesheet",href:"".concat(a,"/styles/apps/").concat(n)}),d.a.createElement("link",{rel:"stylesheet",href:"./custom.css"})),d.a.createElement(T,e))}}]),t}(s.Component));m.a.render(d.a.createElement(M,K.a),document.getElementById("libe-labo-app-root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},48:function(e,t,a){"undefined"!==typeof window&&window.location.protocol,"undefined"!==typeof window&&window.location.hostname;var n={meta:{author:"Lib\xe9 Labo",title:"Les dossiers du Fil vert",url:"https://www.liberation.fr/apps/les-dossiers-du-fil-vert",description:"\xabLib\xe9ration\xbb met l'accent sur l'\xe9cologie et d\xe9crypte chaque mois une th\xe9matique de l'actualit\xe9 environnementale dans un dossier de fond.",image:"/apps/les-dossiers-du-fil-vert/social.jpg",xiti_id:"les-dossiers-du-fil-vert",tweet:""},tracking:{active:!1,format:"les-dossiers-du-fil-vert",article:"home-municipales-2020"},show_header:!0,statics_url:"https://www.liberation.fr/apps/static",api_url:"https://libe-labo-2.site/api",stylesheet:"home-municipales.css",spreadsheet:"https://docs.google.com/spreadsheets/d/e/2PACX-1vQVTpXiMkmWiUGeIqFPoagvKjALYlJWUx7EhdSsM9RQB5TpS-NvnmWdjgGNJV7yOo6AaE60fLsQ_7IV/pub?output=tsv"};e.exports=n},79:function(e,t,a){e.exports=a(152)}},[[79,1,2]]]);
//# sourceMappingURL=main.515942ce.chunk.js.map